!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(e=e||self,t(e.view4js={}))}(this,function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function c(e,t,n){return c=u()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=Function.bind.apply(e,i),a=new r;return n&&s(a,n.prototype),a},c.apply(null,arguments)}function l(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function v(e){var t="function"==typeof Map?new Map:void 0;return(v=function(e){function n(){return c(e,arguments,o(this).constructor)}if(null===e||!l(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),s(n,e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?h(e):t}var f=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n(this,e),this.type=t,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=i,this.cancelable=r,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}return r(e,[{key:"preventDefault",value:function(){return this.defaultPrevented=this.cancelable,this}},{key:"stopPropagation",value:function(){return this.propagationStopped=!0,this}},{key:"stopImmediatePropagation",value:function(){return this.immediatePropagationStopped=this.propagationStopped=!0,this}},{key:"remove",value:function(){return this.removed=!0,this}},{key:"clone",value:function(){var t=new e(this.type,this.bubbles,this.cancelable);for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t}},{key:"set",value:function(e){for(var t in e)this[t]=e[t];return this}},{key:"toString",value:function(){return"[".concat(this.constructor.name," (type=").concat(this.type,")]")}}]),e}(),y=function(){function e(){n(this,e),this._listeners=null,this._captureListeners=null}return r(e,null,[{key:"initialize",value:function(t){var n=e.prototype;t.addEventListener=n.addEventListener,t.on=n.on,t.removeEventListener=t.off=n.removeEventListener,t.removeAllEventListeners=n.removeAllEventListeners,t.hasEventListener=n.hasEventListener,t.dispatchEvent=n.dispatchEvent,t._dispatchEvent=n._dispatchEvent,t.willTrigger=n.willTrigger}}]),r(e,[{key:"addEventListener",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};var r=n[e];return r&&(this.removeEventListener(e,t,i),r=n[e]),r?r.push(t):n[e]=[t],t}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return t.handleEvent&&(n=n||t,t=t.handleEvent),n=n||this,this.addEventListener(e,function(e){t.call(n,e,r),i&&e.remove()},a)}},{key:"removeEventListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n?this._captureListeners:this._listeners;if(i){var r=i[e];if(r)for(var a=r.length,o=0;a>o;o++)if(r[o]===t){1===a?delete i[e]:r.splice(o,1);break}}}},{key:"off",value:function(e,t){this.removeEventListener(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}},{key:"removeAllEventListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null}},{key:"dispatchEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof e){var i=this._listeners;if(!(t||i&&i[e]))return!0;e=new f(e,t,n)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(e){}if(e.bubbles&&this.parent){for(var r=this,a=[r];r.parent;)a.push(r=r.parent);var o,s=a.length;for(o=s-1;o>=0&&!e.propagationStopped;o--)a[o]._dispatchEvent(e,1+(0==o));for(o=1;s>o&&!e.propagationStopped;o++)a[o]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return!e.defaultPrevented}},{key:"hasEventListener",value:function(e){var t=this._listeners,n=this._captureListeners;return!!(t&&t[e]||n&&n[e])}},{key:"willTrigger",value:function(e){for(var t=this;t;){if(t.hasEventListener(e))return!0;t=t.parent}return!1}},{key:"toString",value:function(){return"[".concat(this.constructor.name+this.name?" ".concat(this.name):"","]")}},{key:"_dispatchEvent",value:function(e,t){var n=1===t?this._captureListeners:this._listeners;if(e&&n){var i,r=n[e.type];if(!r||0===(i=r.length))return;try{e.currentTarget=this}catch(e){}try{e.eventPhase=t}catch(e){}e.removed=!1,r=r.slice();for(var a=0;i>a&&!e.immediatePropagationStopped;a++){var o=r[a];o.handleEvent?o.handleEvent(e):o(e),e.removed&&(this.off(e.type,o,1===t),e.removed=!1)}}}}]),e}(),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e),this.routes=t}return r(e,[{key:"addRoute",value:function(e,t,n,i){var r={};r.navEvent=e,r.viewstackId=t,r.viewId=n,r.path=i,this.routes.push(r)}},{key:"findRoute",value:function(e){for(var t=[],n=0;this.routes.length>n;n++)this.routes[n].navEvent==e&&(t=this.routes[n]);return t}},{key:"findViewId",value:function(e,t){for(var n=[],i=0;this.routes.length>i;i++)this.routes[i].navEvent==e&&this.routes[i].path==t&&(n=this.routes[i].viewId);return n}},{key:"findViewStackId",value:function(e,t){for(var n=null,i=0;this.routes.length>i;i++)this.routes[i].navEvent==e&&this.routes[i].path==t&&(n=this.routes[i].viewstackId);return n}},{key:"reset",value:function(){this.routes=[]}},{key:"printRoutes",value:function(){if(this.routes.length>0)for(var e=0;this.routes.length>e;e++)console.log("navEvent:"+this.routes[e].navEvent+" viewstackId:"+this.routes[e].viewstackId+" viewId:"+this.routes[e].viewId);else console.log("No Routes Found")}}]),e}(),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e),this.routes=t}return r(e,[{key:"addRoute",value:function(e,t,n){var i={};i.path=e,i.navigatorId=t,i.parentId=n,this.routes.push(i)}},{key:"findNavigator",value:function(e){for(var t=[],n=0;this.routes.length>n;n++)this.routes[n].path===e&&t.push(this.routes[n].navigatorId);return t}},{key:"findNavigatorParent",value:function(e){for(var t="root",n=0;this.routes.length>n;n++)this.routes[n].navigatorId===e&&(t=this.routes[n].parentId);return t}},{key:"findViewStack",value:function(e){for(var t=null,n=0;this.routes.length>n;n++)this.routes[n].path==e&&(t=this.routes[n].viewstackId);return t}},{key:"reset",value:function(){this.routes=[]}},{key:"printRoutes",value:function(){if(this.routes.length>0)for(var e=0;this.routes.length>e;e++)console.log("path:"+this.routes[e].path+" navigatorId:"+this.routes[e].navigatorId);else console.log("No Routes Found")}}]),e}(),k=function(){function e(){n(this,e)}return r(e,null,[{key:"FORGOTPWD_NAV_EVENT",get:function(){return"Forgotpwd_Nav_Event"}},{key:"REGISTER_NAV_EVENT",get:function(){return"Register_Nav_Event"}},{key:"BACK_NAV_EVENT",get:function(){return"Back_Nav_Event"}},{key:"NAV_CHANGE_EVENT",get:function(){return"navigation_change_event"}},{key:"INITIALIZE_EVENT",get:function(){return"initialize_event"}},{key:"ATTACHED_EVENT",get:function(){return"attached_event"}},{key:"DETACHED_EVENT",get:function(){return"detached_event"}},{key:"ACTIVATE_EVENT",get:function(){return"activate_event"}},{key:"DEACTIVATE_EVENT",get:function(){return"deactivate_event"}},{key:"CHANGE",get:function(){return"change"}},{key:"CLICK",get:function(){return"click"}},{key:"VIEW_EVENT",get:function(){return"view_event"}},{key:"MODEL_EVENT",get:function(){return"model_event"}},{key:"COMPONENT_EVENT",get:function(){return"component_event"}}]),e}(),E=function(e){function t(e){var i;return n(this,t),i=d(this,o(t).call(this)),i.id=e,i}return a(t,e),t}(y),w=function(){function e(){return n(this,e),e.instance||(e.instance=this,this.appEvtChannel=new E("APPLICATIONEVENT"),this.navEvtChannel=new E("NAVIGATIONEVENT")),e.instance}return r(e,[{key:"appEventChannel",get:function(){return this.appEvtChannel}},{key:"navEventChannel",get:function(){return this.navEvtChannel}}]),e}(),m=new w;Object.freeze(m);var V=function(e){function t(e,i,r,a,s,u){var c;return n(this,t),c=d(this,o(t).call(this,e,s,u)),c.type=e,c.eventName=i,c.params=r,c.route=a,c}return a(t,e),r(t,[{key:"clone",value:function(){return new t(this.type,this.eventName,this.params,this.route,this.bubbles,this.cancelable)}}]),t}(f),b=function(){function e(){return n(this,e),e.instance||(e.instance=this,this.counter=0),e.instance}return r(e,[{key:"generate",get:function(){return this.counter++}}]),e}(),N=new b;Object.freeze(N);var A=function(){function e(){n(this,e)}return r(e,null,[{key:"component",value:function(e){return document.querySelector(".vjs-component."+e)}},{key:"container",value:function(e){return document.querySelector(".vjs-container."+e)}},{key:"view",value:function(e){return document.querySelector(".vjs-view."+e)}},{key:"viewStack",value:function(e){return document.querySelector(".vjs-viewstack."+e)}},{key:"viewNavigator",value:function(e){return document.querySelector(".vjs-viewnavigator."+e)}},{key:"constructComponentBaseElement",value:function(e){return'<div class="vjs-component '.concat(e,'"></div>')}},{key:"constructContainerBaseElement",value:function(e){return'<div class="vjs-container '.concat(e,'"></div>')}},{key:"constructViewBaseElement",value:function(e){return'<div class="vjs-view '.concat(e,'"></div>')}},{key:"constructViewStackBaseElement",value:function(e){return'<div class="vjs-viewstack '.concat(e,'"></div>')}},{key:"constructNavigatorBaseElement",value:function(e){return'<div class="vjs-viewnavigator '.concat(e,'"></div>')}},{key:"hideElement",value:function(e){e.style.display="none"}},{key:"showElement",value:function(e){e.style.display="block"}},{key:"isVisible",value:function(e){return"block"==e.style.display}},{key:"generateComponentId",value:function(){return"component"+N.generate}},{key:"generateContainerId",value:function(){return"container"+N.generate}}]),e}(),I=function(e){function t(e,i,r,a){var s;return n(this,t),s=d(this,o(t).call(this)),s.id=e,s.route=i,s.navparams=r,s.parentViewStackId=a,s.isAttached=!1,s.isActive=!1,s.initView(),s}return a(t,e),r(t,[{key:"dispatchNavBackEvent",value:function(e){e.preventDefault();var t=new V(k.NAV_CHANGE_EVENT,k.BACK_NAV_EVENT,null,this.route);m.navEventChannel.dispatchEvent(t)}},{key:"initView",value:function(){}},{key:"createViewContent",value:function(){}},{key:"addViewHandler",value:function(){}},{key:"removeViewHandler",value:function(){}},{key:"bindView",value:function(){}},{key:"unBindView",value:function(){}},{key:"destroy",value:function(){}},{key:"attachView",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!this.isAttached){var t=e;null==t&&(t=A.viewStack(this.parentViewStackId)),t.insertAdjacentHTML("beforeend",A.constructViewBaseElement(this.id)),this.isAttached=!0;var n=this.getViewElement();A.hideElement(n),this.createViewContent(),this.addViewHandler(),this.bindView(),this.dispatchEvent(k.ATTACHED_EVENT)}}},{key:"activateView",value:function(){if(!this.isActive){var e=this.getViewElement();A.showElement(e),this.isActive=!0}}},{key:"deActivateView",value:function(){if(this.isActive){var e=this.getViewElement();A.hideElement(e),this.isActive=!1}}},{key:"detachView",value:function(){if(this.isAttached){this.unBindView(),this.removeViewHandler();var e=this.getViewElement();e.parentNode.removeChild(e),this.isAttached=!1,this.dispatchEvent(k.DETACHED_EVENT)}}},{key:"refreshView",value:function(){}},{key:"getViewElement",value:function(){var e=null;return this.isAttached&&(e=A.view(this.id)),e}},{key:"addToViewElement",value:function(e){this.getViewElement().insertAdjacentHTML("beforeend",e)}}]),t}(y),_=function(){function e(){n(this,e)}return r(e,null,[{key:"LOADING",get:function(){return"loading"}},{key:"LOADED",get:function(){return"loaded"}},{key:"SUCCESS",get:function(){return"success"}},{key:"ERROR",get:function(){return"error"}},{key:"WARNING",get:function(){return"warning"}},{key:"READONLY",get:function(){return"readonly"}},{key:"ENABLED",get:function(){return"enabled"}},{key:"DISABLED",get:function(){return"disabled"}},{key:"DEFAULT",get:function(){return"default"}}]),e}(),C=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=3>=arguments.length||void 0===arguments[3]||arguments[3];return n(this,t),e=d(this,o(t).call(this)),e.isEnabled=!0,e.isAttached=!1,e.elState=_.DEFAULT,e.isRequired=!1,e.isReadOnly=!1,e.createDOMElement=s,e.id=i,e.formId="defaultform",null!=i&&""!=i||(e.id=A.generateComponentId()),e.parentViewId=r,e.parentContainerId=a,e}return a(t,e),r(t,[{key:"init",value:function(){this.initComponent()}},{key:"initComponent",value:function(){}},{key:"createDOMContent",value:function(){}},{key:"addToComponentElement",value:function(e){this.componentElement.insertAdjacentHTML("beforeend",e)}},{key:"addEventHandler",value:function(){}},{key:"removeEventHandler",value:function(){}},{key:"bind",value:function(){}},{key:"unBind",value:function(){}},{key:"changeState",value:function(){this.elState=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",this.changeComponentState()}},{key:"changeComponentState",value:function(){}},{key:"setComponentRequired",value:function(){}},{key:"setComponentReadOnly",value:function(){}},{key:"setComponentEnabled",value:function(){}},{key:"attach",value:function(){if(!this.isAttached){if(this.isAttached=!0,1==this.createDOMElement){A.container(this.parentContainerId).insertAdjacentHTML("beforeend",A.constructComponentBaseElement(this.id));A.hideElement(this.componentElement),this.createDOMContent()}this.addEventHandler(),this.bind(),this.enabled=!0,this.visible=!0,this.dispatchEvent(k.ATTACHED_EVENT)}}},{key:"detach",value:function(){if(this.isAttached){this.unBind(),this.removeEventHandler();var e=this.componentElement;e.parentNode.removeChild(e),this.isAttached=!1,this.dispatchEvent(k.DETACHED_EVENT)}}},{key:"refresh",value:function(){}},{key:"destroy",value:function(){}},{key:"componentElement",get:function(){var e=null;return this.isAttached&&(e=A.component(this.id)),e}},{key:"parentView",get:function(){return this.parentViewId}},{key:"parentContainer",get:function(){return this.parentContainerId}},{key:"currentState",get:function(){return this.elState}},{key:"required",get:function(){return this.isRequired},set:function(){this.isRequired=arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setComponentRequired()}},{key:"readOnly",get:function(){return this.isReadOnly},set:function(){this.isReadOnly=arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.changeState(1==this.isReadOnly?_.READONLY:_.DEFAULT),this.setComponentReadOnly()}},{key:"enabled",get:function(){return this.isEnabled},set:function(){this.isEnabled=arguments.length>0&&void 0!==arguments[0]&&arguments[0],this.setComponentEnabled()}},{key:"visible",get:function(){return A.isVisible(this.componentElement)},set:function(e){var t=this.componentElement;e?A.showElement(t):A.hideElement(t)}}]),t}(y),T=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=2>=arguments.length||void 0===arguments[2]||arguments[2];return n(this,t),e=d(this,o(t).call(this)),e.isEnabled=!1,e.createDOMElement=a,e.id=i,null!=i&&""!=i||(e.id=A.generateContainerId()),e.parentViewId=r,e}return a(t,e),r(t,[{key:"initContainer",value:function(){}},{key:"init",value:function(){this.initContainer()}},{key:"createDOMContent",value:function(){}},{key:"attach",value:function(){if(!this.isAttached){if(parentEl=A.view(this._parentViewId),1==this.createDOMElement){parentEl.insertAdjacentHTML("beforeend",A.constructContainerBaseElement(this.id));A.hideElement(this.element),this.createDOMContent()}this.enabled=!0,this.visible=!0,this.isAttached=!0,this.dispatchEvent(k.ATTACHED_EVENT)}}},{key:"detach",value:function(){if(this.isAttached){var e=this.componentElement;e.parentNode.removeChild(e),this.isAttached=!1,this.dispatchEvent(k.DETACHED_EVENT)}}},{key:"refresh",value:function(){}},{key:"destroy",value:function(){}},{key:"containerElement",get:function(){var e=null;return this.isAttached&&(e=A.container(this.id)),e}},{key:"parent",get:function(){return this._parentViewId}},{key:"enabled",get:function(){return this.isEnabled},set:function(){this.isEnabled=arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"visible",get:function(){return A.isVisible(this.containerElement)},set:function(e){var t=this.containerElement;e?A.showElement(t):A.hideElement(t)}}]),t}(y),S=function(e){function t(){var e,i,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Class";n(this,t);for(var a=arguments.length,s=Array(a>1?a-1:0),u=1;a>u;u++)s[u-1]=arguments[u];return i=d(this,(e=o(t)).call.apply(e,[this].concat(s))),Error.captureStackTrace&&Error.captureStackTrace(h(i),t),i.type=r,i.date=new Date,i}return a(t,e),t}(v(Error)),O=function(e){function t(e,i,r){var a;return n(this,t),a=d(this,o(t).call(this)),a.id=e,a.route=i,a.parentId=r,a.viewStack=[],a.isRendered=!1,a.initViewStack(),a}return a(t,e),r(t,[{key:"initViewStack",value:function(){}},{key:"pushViewElement",value:function(e,t){for(var n in t){var i=t[n];i.isActive&&i.deActivateView()}this.viewStack.push(e)}},{key:"popViewElement",value:function(){this.viewStack.pop()}},{key:"getActiveViewId",value:function(){if(this.viewStack.length>0)return this.viewStack[this.viewStack.length-1]}},{key:"getViewStackElement",value:function(){var e=null;return this.isRendered&&(e=this.getViewStackRootElement()),e}},{key:"getViewStackRootElement",value:function(){return A.viewStack(this.id)}},{key:"render",value:function(){this.isRendered||(this.renderViewStack(),this.renderViewStackContent(),this.isRendered=!0)}},{key:"renderViewStack",value:function(){A.viewNavigator(this.parentId).insertAdjacentHTML("beforeend",A.constructViewStackBaseElement(this.id))}},{key:"renderViewStackContent",value:function(){}},{key:"destroy",value:function(){this.route=null,this.viewStack=[],this.isRendered=!1,A.viewNavigator(this.parentId).removeChild(A.viewStack(this.id)),this.parentId=null,this.id=null}}]),t}(y),R=function(e){function t(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n(this,t),i=d(this,o(t).call(this)),i.id=e,i.parentId=r,i.activeViewId=null,i.activeViewStackId=null,i.activeRoute=null,i.views={},i.viewstacks={},i.eventRoute=new p,i.isRendered=!1,i.history=!0,i.initNavigator(),i}return a(t,e),r(t,[{key:"initNavigator",value:function(){}},{key:"createView",value:function(e,t,n,i){return new I(e,t,n,i)}},{key:"createViewStack",value:function(e,t,n){return new O(e,t,n)}},{key:"navigate",value:function(e,t,n){var i=null;0==this.history&&this.navigateBack(e),i=this.eventRoute.findViewStackId(t,e);var r=this.getViewStack(i);null==r&&(r=this.createViewStack(i,e,this.id)),r.render(),this.activeViewStackId=i,this.viewstacks[i]=r;var a=this.eventRoute.findViewId(t,e),o=this.getView(a);null==o&&(o=this.createView(a,e,n,i)),o.attachView(r.getViewStackElement()),r.pushViewElement(a,this.views),o.activateView(),this.activeViewId=a,this.views[a]=o,this.activeRoute=e}},{key:"navigateBack",value:function(e){if(e==this.activeRoute){var t=this.getViewStack(this.activeViewStackId);t.popViewElement();var n=this.views[this.activeViewId];if(n.deActivateView(),n.detachView(),n.destroy(),n=null,this.views[this.activeViewId]=null,delete this.views[this.activeViewId],1==this.history){this.activeViewId=t.getActiveViewId();this.views[this.activeViewId].activateView(),this.activeRoute=this.views[this.activeViewId].route}}}},{key:"navigateBackToView",value:function(e){}},{key:"navigateToView",value:function(e){}},{key:"getViewStack",value:function(e){return this.viewstacks[e]}},{key:"getView",value:function(e){return this.views[e]}},{key:"render",value:function(){this.isRendered||(this.renderNavigator(),this.renderNavigatorContent())}},{key:"renderNavigator",value:function(){var e=this.parentId,t=null;if(null==(t="root"!=this.parentId?A.view(this.parentId):document.getElementById(e)))throw new ClassError("ViewNavigator","No Parent Element found for Navigator");t.insertAdjacentHTML("beforeend",A.constructNavigatorBaseElement(this.id)),this.isRendered=!0}},{key:"renderNavigatorContent",value:function(){}},{key:"destroy",value:function(){for(var e in this.views){this.views[e].destroy()}for(var t in this.viewstacks){this.viewstacks[t].destroy()}document.getElementById(this.parentId).removeChild(A.viewNavigator(this.id)),this.views=null,this.viewstacks=null,this.parentId=null,this.id=null,this.parentId=null,this.activeViewId=null,this.activeViewStackId=null,this.activeRoute=null,this.eventRoute=null,this.isRendered=!1}},{key:"eventRouter",set:function(e){if(!e instanceof p)throw new ClassError("ViewNavigator","Wrong Type of Router");this.eventRoute=e},get:function(){return this.eventRoute}}]),t}(y),j=function(e){function t(){var e;return n(this,t),e=d(this,o(t).call(this)),e.preinitialize(),e.initialize(),e}return a(t,e),r(t,[{key:"preinitialize",value:function(){var e=this;this.navigators={},this.currentNavigatorIds=[],this.router=new g,this.rootId="root",m.navEventChannel.addEventListener(k.NAV_CHANGE_EVENT,function(t){e.handleNavChangeEvent(t)})}},{key:"initialize",value:function(){}},{key:"createNavigator",value:function(e,t){return new R(e,t)}},{key:"addNavigator",value:function(e,t){this.navigators[t]=e}},{key:"getNavigator",value:function(e){var t=null;return null!=this.navigators[e]&&(t=this.navigators[e]),t}},{key:"findRouteNavigator",value:function(e){return this.router.findNavigator(e)}},{key:"getNavigatorParent",value:function(e){return this.router.findNavigatorParent(e)}},{key:"handleNavChangeEvent",value:function(e){var t=e.route,n=e.eventName,i=e.params,r=this.findRouteNavigator(t);n==k.BACK_NAV_EVENT?this.changeBackNavigation(r,t):(this.currentRoute=t,this.changeNavigation(r,t,n,i))}},{key:"changeBackNavigation",value:function(e,t){if(e.length>0)for(var n=0;e.length>n;n++){var i=e[n],r=this.getNavigator(i);r.navigateBack(t)}}},{key:"changeNavigation",value:function(e,t,n,i){if(this.checkAndDestroyNavigators(e,t),e.length>0)for(var r=0;e.length>r;r++){var a=e[r],o=this.getNavigator(a);if(null==o){var s=this.getNavigatorParent(a);o=this.createNavigator(a,s),this.addNavigator(o,a),o.render()}o.navigate(t,n,i)}}},{key:"checkAndDestroyNavigators",value:function(e,t){var n=[];if(e.length>0)for(var i=0;this.currentNavigatorIds.length>i;i++){var r=this.currentNavigatorIds[i];this.checkUnusedNavigator(r,e)&&n.push(r)}this.destroyUnusedNavigators(n)}},{key:"checkUnusedNavigator",value:function(e,t){for(var n=!0,i=0;t.length>i;i++)e==t[i]&&(n=!1);return n}},{key:"destroyUnusedNavigators",value:function(e){if(e.length>0)for(var t=0;e.length>t;t++){var n=e[t];this.removeNavigator(n)}}},{key:"removeNavigator",value:function(e){var t=this.navigators[e];t.destroy(),t=null,this.navigators[e]=null}},{key:"destroyAll",value:function(){}},{key:"routes",set:function(e){if(!e instanceof g)throw new S("ViewManager","Wrong Type of Router");this.router=e},get:function(){return this.router}}]),t}(y),D=function(e){function t(e,i,r,a,s){var u;return n(this,t),u=d(this,o(t).call(this,e,a,s)),u.type=e,u.eventName=i,u.params=r,u}return a(t,e),r(t,[{key:"clone",value:function(){return new t(this.type,this.eventName,this.params,this.bubbles,this.cancelable)}}]),t}(f),L=function(){function e(){return n(this,e),e.instance||(e.instance=this,this.BindObjDictionary={}),e.instance}return r(e,[{key:"Binds",value:function(e,t,n,i,r){var a={},o=t+"prop",s=null;e.nodeName?(s=e.id,this.addToBindDictionary(s,e,n),a=this.BindObjDictionary[s]):(s=e,this.addToBindDictionary(s,e,n),a=this.BindObjDictionary[s]),null==a.srcPropArray&&(a.srcPropArray=[]),null==a[o]&&(a.srcPropArray.push(t),a[o]={},a[o].value="function"==typeof e[t]?e[t]():e[t]),null==a[o].bindObjArray&&(a[o].bindObjArray=[]),a[o].bindObjArray.push(this.getTargetObject(i,r)),this.BindObjDictionary[s]=a}},{key:"addToBindDictionary",value:function(e,t,n){var i=this;null==this.BindObjDictionary[e]&&(this.BindObjDictionary[e]=t),t.addEventListener(n,function(e){i.synchronise(e)})}},{key:"synchronise",value:function(e){e.preventDefault();var n,i=e.target;console.info(t(i)),n=i.id?i.id:i;for(var r=this.BindObjDictionary[n],a=r.srcPropArray.length,o=0;a>o;o++){var s=r.srcPropArray[o],u=s+"prop",c=void 0;c="function"==typeof r[s]?r[s]():r[s],r[u].value!=c&&(this.synchroniseTargetObj(r,u,s),r[u].value=r[s])}}},{key:"synchroniseTargetObj",value:function(e,t,n){for(var i=e[t].bindObjArray,r=i.length,a=0;r>a;a++){var o=i[a],s=void 0;s="function"==typeof e[n]?e[n]():e[n],null!=o.obj&&("function"==typeof o.obj[o.prop]?o.obj[o.prop](s):o.obj[o.prop]=s)}}},{key:"getTargetObject",value:function(e,t){var n={};return n.obj=e,n.prop=t,n}},{key:"addBinding",value:function(e,t,n,i,r,a){this.Binds(e,t,n,i,r),a&&this.Binds(i,r,n,e,t)}},{key:"removeBinding",value:function(e,t){var n;if(null!=srcObj){if(srcObj.nodeName){var i=srcObj.id;null!=this.BindObjDictionary[i]?(n=this.BindObjDictionary[i],this.removeListeners(n)):(n=this.BindObjDictionary[srcObj],this.removeListeners(n))}else null!=this.BindObjDictionary[srcObj]&&(n=this.BindObjDictionary[srcObj],this.removeListeners(n));if(n.srcPropArray.length>0)for(var r=n.srcPropArray.length,a=0;r>a;a++){var o=n.srcPropArray[a],s=o+"prop";n[s].bindObjArray=[]}}}},{key:"removeListeners",value:function(e,t){var n=this;e.removeEventListener(t,function(e){n.synchronise(e)})}}]),e}(),B=new L;Object.freeze(B),e.BindingUtils=B,e.ClassError=S,e.Component=C,e.Container=T,e.ElementState=_,e.ElementUtils=A,e.Event=f,e.EventBroadCaster=m,e.EventChannel=E,e.EventDispatcher=y,e.EventRouter=p,e.EventUtils=k,e.GenericEvent=D,e.InstanceId=N,e.NavigationEvent=V,e.Router=g,e.View=I,e.ViewManager=j,e.ViewNavigator=R,e.ViewStack=O,Object.defineProperty(e,"__esModule",{value:!0})});
